defaults:
  - eniat
  - _self_

resume_dir: '/home/user/training_state/221225/'
keep_origin_path: False

logger:
  type: StateLogger
  level: 10
  unit: epoch
  interval: 1
  mlflow:
    enable: True
    uri:
  tensorboard:
    enable: True
data:
  fit:
    path: ./test_data.py
    cls: Testset
  eval:
    path:
      - ./data/numpy.npy
      - ./data/numpy2.npy
    type: npy

grader:
  methods: ['acc']
  unit: epoch
  interval: 1

trainer:

  task: train
  type: torch
  label: []

  seed: 666
  batch_size: 1000
  max_step: 100
  unit: epoch
  save_interval: 1
  save_after_eval: True

  distributed:
     type: DDP
     debug: False
     local_size: 2
     world_size: 2
     master_address: 'localhost'
     master_port: '12345'
     backend: gloo
     env_set:
     env_copy:

learner:
  cls: SupremeLearner
  model:
    cls: MyNet
    path: ./model_test.py
    in_features: 256
    out_features: 256
  loss:
    _target_: torch.nn.L1Loss
  optimizer:
    _target_: torch.optim.AdamW
    lr: 0.01
  scheduler:
    _target_: torch.optim.lr_scheduler.LambdaLR
    lr_lambda: 0.99
  